# ?? JTX Concert Ticketing - Complete Architecture

## ??? System Architecture Overview

```
???????????????????????????????????????????????????????????????????????????
?                           USER'S BROWSER                                ?
?                     (https://localhost:5001)                            ?
???????????????????????????????????????????????????????????????????????????
                                 ?
                                 ? HTTP Request
                                 ?
???????????????????????????????????????????????????????????????????????????
?                    ASP.NET CORE WEB APPLICATION                         ?
?                                                                         ?
?  ????????????????????????????????????????????????????????????????????  ?
?  ?  Controllers/HomeController.cs                                   ?  ?
?  ?  - Receives HTTP requests                                        ?  ?
?  ?  - Calls database through ApplicationDbContext                   ?  ?
?  ?  - Returns view with data                                        ?  ?
?  ????????????????????????????????????????????????????????????????????  ?
?                           ?                                             ?
?                           ? Queries via EF Core                         ?
?                           ?                                             ?
?  ????????????????????????????????????????????????????????????????????  ?
?  ?  Data/ApplicationDbContext.cs                                    ?  ?
?  ?  - DbSet<Concert> Concerts                                       ?  ?
?  ?  - DbSet<Venue> Venues                                          ?  ?
?  ?  - DbSet<Ticket> Tickets                                        ?  ?
?  ?  - DbSet<Order> Orders                                          ?  ?
?  ?  - Manages relationships and queries                            ?  ?
?  ????????????????????????????????????????????????????????????????????  ?
?                           ?                                             ?
???????????????????????????????????????????????????????????????????????????
                            ? ADO.NET / SQL Connection
                            ?
???????????????????????????????????????????????????????????????????????????
?                   SQL SERVER LOCALDB                                    ?
?                   Database: JTXConcertDB                                ?
?                                                                         ?
?  ??????????????????  ??????????????????  ??????????????????          ?
?  ?   Venues       ?  ?   Concerts     ?  ?    Tickets     ?          ?
?  ?  (6 rows)      ????  (6 rows)      ????  (0 rows)      ?          ?
?  ??????????????????  ??????????????????  ??????????????????          ?
?                                                ?                        ?
?                                          ??????????????????            ?
?                                          ?    Orders      ?            ?
?                                          ?  (0 rows)      ?            ?
?                                          ??????????????????            ?
???????????????????????????????????????????????????????????????????????????
                            ?
                            ? Query/Manage
                            ?
                    ??????????????????
                    ?  Beekeeper     ?
                    ?   Studio       ?
                    ?  (Database     ?
                    ?   GUI Tool)    ?
                    ??????????????????
```

---

## ?? Project Structure

```
JTX-Ecom/
?
??? Controllers/
?   ??? HomeController.cs ..................... ?? Handles HTTP requests
?
??? Data/
?   ??? ApplicationDbContext.cs ............... ??? Database context
?
??? Models/
?   ??? Concert.cs ............................ ?? Concert entity
?   ??? Venue.cs .............................. ??? Venue entity
?   ??? Ticket.cs ............................. ?? Ticket entity
?   ??? Order.cs .............................. ?? Order entity
?
??? Views/
?   ??? Home/
?   ?   ??? Index.cshtml ...................... ?? Homepage view
?   ??? Shared/
?       ??? _Layout.cshtml .................... ?? Main layout
?
??? wwwroot/
?   ??? css/
?   ?   ??? site.css .......................... ?? Custom styles
?   ??? assets/
?       ??? images/ ........................... ??? Concert images
?
??? Migrations/ ............................... ?? EF Core migrations
?
??? appsettings.json .......................... ?? Configuration
??? Program.cs ................................ ?? App startup
?
??? Documentation/
    ??? DATABASE_GUIDE.md ..................... ?? Database docs
    ??? BEEKEEPER_CONNECTION.md ............... ?? Beekeeper guide
    ??? DATABASE_COMPLETE.md .................. ? Complete guide
```

---

## ?? Request Flow (When User Visits Homepage)

```
1. User navigates to https://localhost:5001
   ?
2. ASP.NET Core routes to HomeController.Index()
   ?
3. Controller queries database:
   var concerts = await _context.Concerts
                    .Include(c => c.Venue)
                    .Where(c => c.IsActive)
                    .ToListAsync();
   ?
4. Entity Framework translates to SQL:
   SELECT c.*, v.* 
   FROM Concerts c
   INNER JOIN Venues v ON c.VenueId = v.VenueId
   WHERE c.IsActive = 1
   ?
5. SQL Server returns data
   ?
6. EF Core maps data to C# objects (List<Concert>)
   ?
7. Controller passes data to view:
   return View(concerts);
   ?
8. Razor engine renders HTML with data:
   @foreach (var concert in Model)
   {
       <h3>@concert.Title</h3>
       <p>@concert.Venue.Name</p>
   }
   ?
9. HTML sent to browser
   ?
10. User sees 6 concerts with venue info! ??
```

---

## ??? Database Tables Detail

### Venues Table
```sql
CREATE TABLE Venues (
    VenueId INT PRIMARY KEY IDENTITY,
    Name NVARCHAR(200) NOT NULL,
    Address NVARCHAR(200) NOT NULL,
    City NVARCHAR(100) NOT NULL,
    State NVARCHAR(100) NOT NULL,
    ZipCode NVARCHAR(20) NOT NULL,
    Country NVARCHAR(50),
    Capacity INT NOT NULL,
    PhoneNumber NVARCHAR(20),
    ImageUrl NVARCHAR(500),
    IsActive BIT NOT NULL,
    CreatedAt DATETIME2 NOT NULL
);
```

### Concerts Table
```sql
CREATE TABLE Concerts (
    ConcertId INT PRIMARY KEY IDENTITY,
    Title NVARCHAR(200) NOT NULL,
    Description NVARCHAR(1000),
    EventDate DATETIME2 NOT NULL,
    EventTime DATETIME2 NOT NULL,
    Artist NVARCHAR(100) NOT NULL,
    Genre NVARCHAR(50) NOT NULL,
    ImageUrl NVARCHAR(500),
    BasePrice DECIMAL(18,2) NOT NULL,
    AvailableTickets INT NOT NULL,
    TotalTickets INT NOT NULL,
    IsActive BIT NOT NULL,
    CreatedAt DATETIME2 NOT NULL,
    UpdatedAt DATETIME2,
    VenueId INT NOT NULL,
    FOREIGN KEY (VenueId) REFERENCES Venues(VenueId)
);
```

### Tickets Table
```sql
CREATE TABLE Tickets (
    TicketId INT PRIMARY KEY IDENTITY,
    TicketNumber NVARCHAR(50) UNIQUE NOT NULL,
    TicketType NVARCHAR(50) NOT NULL,
    Price DECIMAL(18,2) NOT NULL,
    Status NVARCHAR(20) NOT NULL,
    SeatNumber NVARCHAR(50),
    Section NVARCHAR(50),
    CreatedAt DATETIME2 NOT NULL,
    SoldAt DATETIME2,
    ConcertId INT NOT NULL,
    OrderId INT,
    FOREIGN KEY (ConcertId) REFERENCES Concerts(ConcertId),
    FOREIGN KEY (OrderId) REFERENCES Orders(OrderId)
);
```

### Orders Table
```sql
CREATE TABLE Orders (
    OrderId INT PRIMARY KEY IDENTITY,
    OrderNumber NVARCHAR(50) UNIQUE NOT NULL,
    CustomerName NVARCHAR(200) NOT NULL,
    CustomerEmail NVARCHAR(200) NOT NULL,
    CustomerPhone NVARCHAR(20) NOT NULL,
    TotalAmount DECIMAL(18,2) NOT NULL,
    PaymentStatus NVARCHAR(20) NOT NULL,
    PaymentMethod NVARCHAR(100),
    TransactionId NVARCHAR(200),
    OrderDate DATETIME2 NOT NULL,
    PaymentDate DATETIME2,
    Quantity INT NOT NULL
);
```

---

## ?? Current Database State

```
Venues Table (6 rows):
?????????????????????????????????????????????????????????????
? VenueId ? Name                   ? City        ? Capacity ?
?????????????????????????????????????????????????????????????
?    1    ? Madison Square Garden  ? New York    ?  20,000  ?
?    2    ? Staples Center         ? Los Angeles ?  19,000  ?
?    3    ? Blue Note              ? Chicago     ?    500   ?
?    4    ? Ultra Arena            ? Miami       ?  10,000  ?
?    5    ? Grand Ole Opry         ? Nashville   ?   4,400  ?
?    6    ? Barclays Center        ? Brooklyn    ?  19,000  ?
?????????????????????????????????????????????????????????????

Concerts Table (6 rows):
????????????????????????????????????????????????????????????????????????????
? ConcertId ? Title                     ? EventDate    ? Price    ? VenueId?
????????????????????????????????????????????????????????????????????????????
?     1     ? Rock Festival 2025        ? 2025-03-15   ? $89.00   ?   1    ?
?     2     ? Pop Extravaganza          ? 2025-04-05   ? $125.00  ?   2    ?
?     3     ? Jazz Night Live           ? 2025-04-20   ? $65.00   ?   3    ?
?     4     ? Electronic Dance Night    ? 2025-05-10   ? $149.00  ?   4    ?
?     5     ? Country Music Fest        ? 2025-06-02   ? $79.00   ?   5    ?
?     6     ? Hip Hop Summit            ? 2025-06-21   ? $95.00   ?   6    ?
????????????????????????????????????????????????????????????????????????????

Tickets Table: Empty (0 rows) - Will be populated when users buy tickets
Orders Table: Empty (0 rows) - Will be populated when users checkout
```

---

## ?? Technology Stack

```
???????????????????????????????????????????
?        PRESENTATION LAYER               ?
?  • Razor Views (.cshtml)                ?
?  • HTML5 + CSS3                         ?
?  • Bootstrap 5                          ?
?  • Font Awesome Icons                   ?
?  • JavaScript                           ?
???????????????????????????????????????????
              ?
???????????????????????????????????????????
?        APPLICATION LAYER                ?
?  • ASP.NET Core 9 MVC                   ?
?  • C# 13.0                              ?
?  • Dependency Injection                 ?
?  • Async/Await Pattern                  ?
???????????????????????????????????????????
              ?
???????????????????????????????????????????
?        DATA ACCESS LAYER                ?
?  • Entity Framework Core 9              ?
?  • LINQ Queries                         ?
?  • Code-First Migrations                ?
?  • Repository Pattern                   ?
???????????????????????????????????????????
              ?
???????????????????????????????????????????
?        DATABASE LAYER                   ?
?  • SQL Server LocalDB                   ?
?  • Relational Database                  ?
?  • Indexed Columns                      ?
?  • Foreign Key Constraints              ?
???????????????????????????????????????????
```

---

## ?? How Database Works - Simple Explanation

### What is Entity Framework Core?
Think of it as a **translator** between C# and SQL Server:

**Without EF Core (Hard Way):**
```csharp
// You'd have to write raw SQL
string sql = "SELECT * FROM Concerts WHERE IsActive = 1";
// Execute SQL, read results manually, create objects...
```

**With EF Core (Easy Way):**
```csharp
// Just write C# - EF translates to SQL automatically!
var concerts = await _context.Concerts
    .Where(c => c.IsActive)
    .ToListAsync();
```

### What is a DbContext?
It's your **database connection manager**:
- Opens/closes connections automatically
- Tracks changes to objects
- Saves changes back to database
- Manages relationships between tables

### What are Models?
They're **blueprints** for database tables:

**C# Model:**
```csharp
public class Concert
{
    public int ConcertId { get; set; }
    public string Title { get; set; }
    public decimal BasePrice { get; set; }
}
```

**Becomes SQL Table:**
```sql
CREATE TABLE Concerts (
    ConcertId INT PRIMARY KEY,
    Title NVARCHAR(200),
    BasePrice DECIMAL(18,2)
);
```

### What are Migrations?
They're **version control for your database**:
- Track changes to database schema
- Can upgrade or downgrade database
- Keep all developers in sync

---

## ? Summary - What You Have Now

### ? Features Implemented:
- ? SQL Server LocalDB database
- ? 4 related tables (Venues, Concerts, Tickets, Orders)
- ? 6 sample venues with real locations
- ? 6 sample concerts with pricing and dates
- ? Entity Framework Core integration
- ? Dynamic homepage loading data from database
- ? Beekeeper Studio compatible
- ? Type-safe C# models
- ? LINQ query support
- ? Proper relationships and foreign keys

### ?? Ready to Build:
- ?? Ticket booking system
- ?? User authentication
- ?? Payment processing
- ?? Email confirmations
- ?? Search and filtering
- ?? Admin dashboard
- ?? Mobile tickets

---

## ?? You're All Set!

Run your app and see the magic:
```bash
dotnet run
```

Open Beekeeper to manage data visually!

**Happy Coding! ????**
